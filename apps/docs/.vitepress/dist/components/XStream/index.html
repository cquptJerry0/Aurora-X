<!doctype html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1"
    />
    <title>XStream 流式数据处理工具 | Aurora-X</title>
    <meta name="description" content="Aurora X 组件库文档" />
    <meta name="generator" content="VitePress v1.6.3" />
    <link
      rel="preload stylesheet"
      href="/Aurora-X/assets/style.BY9W1CA-.css"
      as="style"
    />
    <link
      rel="preload stylesheet"
      href="/Aurora-X/vp-icons.css"
      as="style"
    />

    <script
      type="module"
      src="/Aurora-X/assets/app.C8DhWv3O.js"
    ></script>
    <link
      rel="preload"
      href="/Aurora-X/assets/inter-roman-latin.Di8DUHzh.woff2"
      as="font"
      type="font/woff2"
      crossorigin=""
    />
    <link
      rel="modulepreload"
      href="/Aurora-X/assets/chunks/theme.DlBx9FtO.js"
    />
    <link
      rel="modulepreload"
      href="/Aurora-X/assets/chunks/framework.zDigGmb2.js"
    />
    <link
      rel="modulepreload"
      href="/Aurora-X/assets/components_XStream_index.md.CxW8VXw7.lean.js"
    />
    <script id="check-dark-mode">
      ;(() => {
        const e =
            localStorage.getItem('vitepress-theme-appearance') ||
            'auto',
          a = window.matchMedia(
            '(prefers-color-scheme: dark)'
          ).matches
        ;(!e || e === 'auto' ? a : e === 'dark') &&
          document.documentElement.classList.add('dark')
      })()
    </script>
    <script id="check-mac-os">
      document.documentElement.classList.toggle(
        'mac',
        /Mac|iPhone|iPod|iPad/i.test(navigator.platform)
      )
    </script>
  </head>
  <body>
    <div id="app">
      <div class="Layout" data-v-a9a9e638>
        <!--[--><!--]--><!--[--><span
          tabindex="-1"
          data-v-492508fc
        ></span
        ><a
          href="#VPContent"
          class="VPSkipLink visually-hidden"
          data-v-492508fc
          >Skip to content</a
        ><!--]--><!---->
        <header class="VPNav" data-v-a9a9e638 data-v-f1e365da>
          <div class="VPNavBar" data-v-f1e365da data-v-822684d1>
            <div class="wrapper" data-v-822684d1>
              <div class="container" data-v-822684d1>
                <div class="title" data-v-822684d1>
                  <div
                    class="VPNavBarTitle has-sidebar"
                    data-v-822684d1
                    data-v-0f4f798b
                  >
                    <a
                      class="title"
                      href="/Aurora-X/"
                      data-v-0f4f798b
                      ><!--[--><!--]--><!----><span
                        data-v-0f4f798b
                        >Aurora-X</span
                      ><!--[--><!--]--></a
                    >
                  </div>
                </div>
                <div class="content" data-v-822684d1>
                  <div class="content-body" data-v-822684d1>
                    <!--[--><!--]-->
                    <div
                      class="VPNavBarSearch search"
                      data-v-822684d1
                    >
                      <!---->
                    </div>
                    <nav
                      aria-labelledby="main-nav-aria-label"
                      class="VPNavBarMenu menu"
                      data-v-822684d1
                      data-v-e6d46098
                    >
                      <span
                        id="main-nav-aria-label"
                        class="visually-hidden"
                        data-v-e6d46098
                      >
                        Main Navigation </span
                      ><!--[--><!--[--><a
                        class="VPLink link VPNavBarMenuLink"
                        href="/Aurora-X/"
                        tabindex="0"
                        data-v-e6d46098
                        data-v-956ec74c
                        ><!--[--><span data-v-956ec74c>首页</span
                        ><!--]--></a
                      ><!--]--><!--[--><a
                        class="VPLink link VPNavBarMenuLink"
                        href="/Aurora-X/guide/use/"
                        tabindex="0"
                        data-v-e6d46098
                        data-v-956ec74c
                        ><!--[--><span data-v-956ec74c>指南</span
                        ><!--]--></a
                      ><!--]--><!--[--><a
                        class="VPLink link VPNavBarMenuLink"
                        href="/Aurora-X/components/Bubble/"
                        tabindex="0"
                        data-v-e6d46098
                        data-v-956ec74c
                        ><!--[--><span data-v-956ec74c>组件</span
                        ><!--]--></a
                      ><!--]--><!--]-->
                    </nav>
                    <!---->
                    <div
                      class="VPNavBarAppearance appearance"
                      data-v-822684d1
                      data-v-af096f4a
                    >
                      <button
                        class="VPSwitch VPSwitchAppearance"
                        type="button"
                        role="switch"
                        title
                        aria-checked="false"
                        data-v-af096f4a
                        data-v-e40a8bb6
                        data-v-4a1c76db
                      >
                        <span class="check" data-v-4a1c76db
                          ><span class="icon" data-v-4a1c76db
                            ><!--[--><span
                              class="vpi-sun sun"
                              data-v-e40a8bb6
                            ></span
                            ><span
                              class="vpi-moon moon"
                              data-v-e40a8bb6
                            ></span
                            ><!--]--></span
                          ></span
                        >
                      </button>
                    </div>
                    <div
                      class="VPSocialLinks VPNavBarSocialLinks social-links"
                      data-v-822684d1
                      data-v-164c457f
                      data-v-ee7a9424
                    >
                      <!--[--><a
                        class="VPSocialLink no-icon"
                        href="https://github.com/cquptJerry0/Aurora-X"
                        aria-label="github"
                        target="_blank"
                        rel="noopener"
                        data-v-ee7a9424
                        data-v-d26d30cb
                        ><span
                          class="vpi-social-github"
                        ></span></a
                      ><a
                        class="VPSocialLink no-icon"
                        href="https://www.npmjs.com/package/vue-aurora-x"
                        aria-label="npm"
                        target="_blank"
                        rel="noopener"
                        data-v-ee7a9424
                        data-v-d26d30cb
                        ><span class="vpi-social-npm"></span></a
                      ><!--]-->
                    </div>
                    <div
                      class="VPFlyout VPNavBarExtra extra"
                      data-v-822684d1
                      data-v-925effce
                      data-v-04f5c5e9
                    >
                      <button
                        type="button"
                        class="button"
                        aria-haspopup="true"
                        aria-expanded="false"
                        aria-label="extra navigation"
                        data-v-04f5c5e9
                      >
                        <span
                          class="vpi-more-horizontal icon"
                          data-v-04f5c5e9
                        ></span>
                      </button>
                      <div class="menu" data-v-04f5c5e9>
                        <div
                          class="VPMenu"
                          data-v-04f5c5e9
                          data-v-7dd3104a
                        >
                          <!----><!--[--><!--[--><!---->
                          <div class="group" data-v-925effce>
                            <div
                              class="item appearance"
                              data-v-925effce
                            >
                              <p class="label" data-v-925effce>
                                Appearance
                              </p>
                              <div
                                class="appearance-action"
                                data-v-925effce
                              >
                                <button
                                  class="VPSwitch VPSwitchAppearance"
                                  type="button"
                                  role="switch"
                                  title
                                  aria-checked="false"
                                  data-v-925effce
                                  data-v-e40a8bb6
                                  data-v-4a1c76db
                                >
                                  <span
                                    class="check"
                                    data-v-4a1c76db
                                    ><span
                                      class="icon"
                                      data-v-4a1c76db
                                      ><!--[--><span
                                        class="vpi-sun sun"
                                        data-v-e40a8bb6
                                      ></span
                                      ><span
                                        class="vpi-moon moon"
                                        data-v-e40a8bb6
                                      ></span
                                      ><!--]--></span
                                    ></span
                                  >
                                </button>
                              </div>
                            </div>
                          </div>
                          <div class="group" data-v-925effce>
                            <div
                              class="item social-links"
                              data-v-925effce
                            >
                              <div
                                class="VPSocialLinks social-links-list"
                                data-v-925effce
                                data-v-ee7a9424
                              >
                                <!--[--><a
                                  class="VPSocialLink no-icon"
                                  href="https://github.com/cquptJerry0/Aurora-X"
                                  aria-label="github"
                                  target="_blank"
                                  rel="noopener"
                                  data-v-ee7a9424
                                  data-v-d26d30cb
                                  ><span
                                    class="vpi-social-github"
                                  ></span></a
                                ><a
                                  class="VPSocialLink no-icon"
                                  href="https://www.npmjs.com/package/vue-aurora-x"
                                  aria-label="npm"
                                  target="_blank"
                                  rel="noopener"
                                  data-v-ee7a9424
                                  data-v-d26d30cb
                                  ><span
                                    class="vpi-social-npm"
                                  ></span></a
                                ><!--]-->
                              </div>
                            </div>
                          </div>
                          <!--]--><!--]-->
                        </div>
                      </div>
                    </div>
                    <!--[--><!--]--><button
                      type="button"
                      class="VPNavBarHamburger hamburger"
                      aria-label="mobile navigation"
                      aria-expanded="false"
                      aria-controls="VPNavScreen"
                      data-v-822684d1
                      data-v-5dea55bf
                    >
                      <span class="container" data-v-5dea55bf
                        ><span class="top" data-v-5dea55bf></span
                        ><span
                          class="middle"
                          data-v-5dea55bf
                        ></span
                        ><span
                          class="bottom"
                          data-v-5dea55bf
                        ></span
                      ></span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="divider" data-v-822684d1>
              <div class="divider-line" data-v-822684d1></div>
            </div>
          </div>
          <!---->
        </header>
        <div
          class="VPLocalNav has-sidebar empty"
          data-v-a9a9e638
          data-v-070ab83d
        >
          <div class="container" data-v-070ab83d>
            <button
              class="menu"
              aria-expanded="false"
              aria-controls="VPSidebarNav"
              data-v-070ab83d
            >
              <span
                class="vpi-align-left menu-icon"
                data-v-070ab83d
              ></span
              ><span class="menu-text" data-v-070ab83d
                >Menu</span
              >
            </button>
            <div
              class="VPLocalNavOutlineDropdown"
              style="--vp-vh: 0px"
              data-v-070ab83d
              data-v-168ddf5d
            >
              <button data-v-168ddf5d>Return to top</button
              ><!---->
            </div>
          </div>
        </div>
        <aside class="VPSidebar" data-v-a9a9e638 data-v-18756405>
          <div class="curtain" data-v-18756405></div>
          <nav
            class="nav"
            id="VPSidebarNav"
            aria-labelledby="sidebar-aria-label"
            tabindex="-1"
            data-v-18756405
          >
            <span
              class="visually-hidden"
              id="sidebar-aria-label"
              data-v-18756405
            >
              Sidebar Navigation </span
            ><!--[--><!--]--><!--[-->
            <div class="no-transition group" data-v-9e426adc>
              <section
                class="VPSidebarItem level-0"
                data-v-9e426adc
                data-v-a4b0d9bf
              >
                <div
                  class="item"
                  role="button"
                  tabindex="0"
                  data-v-a4b0d9bf
                >
                  <div class="indicator" data-v-a4b0d9bf></div>
                  <h2 class="text" data-v-a4b0d9bf>配置</h2>
                  <!---->
                </div>
                <div class="items" data-v-a4b0d9bf>
                  <!--[-->
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/Config/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          Config 配置
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <!--]-->
                </div>
              </section>
            </div>
            <div class="no-transition group" data-v-9e426adc>
              <section
                class="VPSidebarItem level-0"
                data-v-9e426adc
                data-v-a4b0d9bf
              >
                <div
                  class="item"
                  role="button"
                  tabindex="0"
                  data-v-a4b0d9bf
                >
                  <div class="indicator" data-v-a4b0d9bf></div>
                  <h2 class="text" data-v-a4b0d9bf>输出</h2>
                  <!---->
                </div>
                <div class="items" data-v-a4b0d9bf>
                  <!--[-->
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/Bubble/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          Bubble 气泡
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/BubbleList/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          BubbleList 气泡列表
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/Typewriter/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          Typewriter 打字机
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <!--]-->
                </div>
              </section>
            </div>
            <div class="no-transition group" data-v-9e426adc>
              <section
                class="VPSidebarItem level-0"
                data-v-9e426adc
                data-v-a4b0d9bf
              >
                <div
                  class="item"
                  role="button"
                  tabindex="0"
                  data-v-a4b0d9bf
                >
                  <div class="indicator" data-v-a4b0d9bf></div>
                  <h2 class="text" data-v-a4b0d9bf>输入</h2>
                  <!---->
                </div>
                <div class="items" data-v-a4b0d9bf>
                  <!--[-->
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/Attachments/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          Attachments 附件
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <!--]-->
                </div>
              </section>
            </div>
            <div class="no-transition group" data-v-9e426adc>
              <section
                class="VPSidebarItem level-0 has-active"
                data-v-9e426adc
                data-v-a4b0d9bf
              >
                <div
                  class="item"
                  role="button"
                  tabindex="0"
                  data-v-a4b0d9bf
                >
                  <div class="indicator" data-v-a4b0d9bf></div>
                  <h2 class="text" data-v-a4b0d9bf>工具</h2>
                  <!---->
                </div>
                <div class="items" data-v-a4b0d9bf>
                  <!--[-->
                  <div
                    class="VPSidebarItem level-1 is-link"
                    data-v-a4b0d9bf
                    data-v-a4b0d9bf
                  >
                    <div class="item" data-v-a4b0d9bf>
                      <div
                        class="indicator"
                        data-v-a4b0d9bf
                      ></div>
                      <a
                        class="VPLink link link"
                        href="/Aurora-X/components/XStream/"
                        data-v-a4b0d9bf
                        ><!--[-->
                        <p class="text" data-v-a4b0d9bf>
                          XStream 流式数据处理
                        </p>
                        <!--]--></a
                      ><!---->
                    </div>
                    <!---->
                  </div>
                  <!--]-->
                </div>
              </section>
            </div>
            <!--]--><!--[--><!--]-->
          </nav>
        </aside>
        <div
          class="VPContent has-sidebar"
          id="VPContent"
          data-v-a9a9e638
          data-v-91765379
        >
          <div
            class="VPDoc has-sidebar has-aside"
            data-v-91765379
            data-v-83890dd9
          >
            <!--[--><!--]-->
            <div class="container" data-v-83890dd9>
              <div class="aside" data-v-83890dd9>
                <div class="aside-curtain" data-v-83890dd9></div>
                <div class="aside-container" data-v-83890dd9>
                  <div class="aside-content" data-v-83890dd9>
                    <div
                      class="VPDocAside"
                      data-v-83890dd9
                      data-v-6d7b3c46
                    >
                      <!--[--><!--]--><!--[--><!--]-->
                      <nav
                        aria-labelledby="doc-outline-aria-label"
                        class="VPDocAsideOutline"
                        data-v-6d7b3c46
                        data-v-b38bf2ff
                      >
                        <div class="content" data-v-b38bf2ff>
                          <div
                            class="outline-marker"
                            data-v-b38bf2ff
                          ></div>
                          <div
                            aria-level="2"
                            class="outline-title"
                            id="doc-outline-aria-label"
                            role="heading"
                            data-v-b38bf2ff
                          >
                            On this page
                          </div>
                          <ul
                            class="VPDocOutlineItem root"
                            data-v-b38bf2ff
                            data-v-3f927ebe
                          >
                            <!--[--><!--]-->
                          </ul>
                        </div>
                      </nav>
                      <!--[--><!--]-->
                      <div class="spacer" data-v-6d7b3c46></div>
                      <!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]-->
                    </div>
                  </div>
                </div>
              </div>
              <div class="content" data-v-83890dd9>
                <div class="content-container" data-v-83890dd9>
                  <!--[--><!--]-->
                  <main class="main" data-v-83890dd9>
                    <div
                      style="position: relative"
                      class="vp-doc _Aurora-X_components_XStream_"
                      data-v-83890dd9
                    >
                      <div>
                        <h1
                          id="xstream-流式数据处理工具"
                          tabindex="-1"
                        >
                          XStream 流式数据处理工具
                          <a
                            class="header-anchor"
                            href="#xstream-流式数据处理工具"
                            aria-label='Permalink to "XStream 流式数据处理工具"'
                            >​</a
                          >
                        </h1>
                        <p>
                          XStream
                          是一个高效处理流式数据的工具库，主要用于处理服务器发送事件(SSE)和其他流式数据格式。
                        </p>
                        <h2 id="功能特点" tabindex="-1">
                          功能特点
                          <a
                            class="header-anchor"
                            href="#功能特点"
                            aria-label='Permalink to "功能特点"'
                            >​</a
                          >
                        </h2>
                        <ul>
                          <li>
                            🌊 流式解析 -
                            高效处理二进制流和文本流数据
                          </li>
                          <li>
                            🔄 SSE 支持 -
                            原生支持服务器发送事件(SSE)格式解析
                          </li>
                          <li>
                            ⏹️ 中断控制 -
                            支持随时中断和取消流处理
                          </li>
                          <li>
                            🔄 异步迭代 - 支持
                            <code>for await...of</code>
                            语法的异步迭代
                          </li>
                          <li>
                            🔌 可扩展性 -
                            支持自定义转换流和分隔符
                          </li>
                          <li>
                            🛡️ 错误处理 - 内置错误捕获和处理机制
                          </li>
                        </ul>
                        <h2 id="基础用法" tabindex="-1">
                          基础用法
                          <a
                            class="header-anchor"
                            href="#基础用法"
                            aria-label='Permalink to "基础用法"'
                            >​</a
                          >
                        </h2>
                        <h3 id="处理-sse-流数据" tabindex="-1">
                          处理 SSE 流数据
                          <a
                            class="header-anchor"
                            href="#处理-sse-流数据"
                            aria-label='Permalink to "处理 SSE 流数据"'
                            >​</a
                          >
                        </h3>
                        <div
                          class="language-typescript vp-adaptive-theme"
                        >
                          <button
                            title="Copy Code"
                            class="copy"
                          ></button
                          ><span class="lang">typescript</span>
                          <pre
                            class="shiki shiki-themes github-light github-dark vp-code"
                            tabindex="0"
                          ><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { XStream } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;aurora-x&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleSSEStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 发起流式请求</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fetch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &#39;https://api.example.com/events&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      method: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;POST&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      headers: { </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Content-Type&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;application/json&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      body: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ prompt: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;你好，请继续对话&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 检查响应状态</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.ok </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">response.body) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    throw</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;请求失败&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 创建中断控制器</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> controller</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbortController</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 初始化 XStream</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      readableStream: response.body,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      errorHandler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;流处理错误:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, error),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    controller.signal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  )</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 使用异步迭代器处理流数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stream) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 处理每个事件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (event.event </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;delta&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> event.data) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(event.data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;收到内容:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data.content)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 条件性中断流</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (someCondition) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">abort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        break</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;处理流时发生错误:&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, error)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre>
                        </div>
                        <h3 id="自定义转换流" tabindex="-1">
                          自定义转换流
                          <a
                            class="header-anchor"
                            href="#自定义转换流"
                            aria-label='Permalink to "自定义转换流"'
                            >​</a
                          >
                        </h3>
                        <div
                          class="language-typescript vp-adaptive-theme"
                        >
                          <button
                            title="Copy Code"
                            class="copy"
                          ></button
                          ><span class="lang">typescript</span>
                          <pre
                            class="shiki shiki-themes github-light github-dark vp-code"
                            tabindex="0"
                          ><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { XStream, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> XStreamOptions } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;aurora-x&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 创建自定义转换流</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> customTransformer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TransformStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  string,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  CustomOutput</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  transform</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">chunk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">controller</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 自定义逻辑处理每个数据块</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> processed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> processChunk</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(chunk)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    controller.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">enqueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(processed)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 配置 XStream 使用自定义转换流</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStreamOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CustomOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  readableStream: response.body,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transformStream: customTransformer,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> stream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(options)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 处理转换后的数据</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> of</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> stream) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 使用自定义格式的数据</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre>
                        </div>
                        <h2 id="api-参考" tabindex="-1">
                          API 参考
                          <a
                            class="header-anchor"
                            href="#api-参考"
                            aria-label='Permalink to "API 参考"'
                            >​</a
                          >
                        </h2>
                        <h3 id="xstream-函数" tabindex="-1">
                          XStream 函数
                          <a
                            class="header-anchor"
                            href="#xstream-函数"
                            aria-label='Permalink to "XStream 函数"'
                            >​</a
                          >
                        </h3>
                        <div
                          class="language-typescript vp-adaptive-theme"
                        >
                          <button
                            title="Copy Code"
                            class="copy"
                          ></button
                          ><span class="lang">typescript</span>
                          <pre
                            class="shiki shiki-themes github-light github-dark vp-code"
                            tabindex="0"
                          ><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SSEOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStreamOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  signal</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbortSignal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XReadableStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre>
                        </div>
                        <h3
                          id="xstreamoptions-选项"
                          tabindex="-1"
                        >
                          XStreamOptions 选项
                          <a
                            class="header-anchor"
                            href="#xstreamoptions-选项"
                            aria-label='Permalink to "XStreamOptions 选项"'
                            >​</a
                          >
                        </h3>
                        <table tabindex="0">
                          <thead>
                            <tr>
                              <th>选项名</th>
                              <th>说明</th>
                              <th>类型</th>
                              <th>默认值</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>readableStream</td>
                              <td>二进制数据可读流</td>
                              <td>
                                <code
                                  >ReadableStream&lt;Uint8Array&gt;</code
                                >
                              </td>
                              <td><strong>必填</strong></td>
                            </tr>
                            <tr>
                              <td>transformStream</td>
                              <td>自定义转换流</td>
                              <td>
                                <code
                                  >TransformStream&lt;string,
                                  Output&gt;</code
                                >
                              </td>
                              <td>-</td>
                            </tr>
                            <tr>
                              <td>streamSeparator</td>
                              <td>事件分隔符</td>
                              <td><code>string</code></td>
                              <td>
                                <code>&#39;\n\n&#39;</code>
                              </td>
                            </tr>
                            <tr>
                              <td>partSeparator</td>
                              <td>行分隔符</td>
                              <td><code>string</code></td>
                              <td><code>&#39;\n&#39;</code></td>
                            </tr>
                            <tr>
                              <td>kvSeparator</td>
                              <td>键值分隔符</td>
                              <td><code>string</code></td>
                              <td><code>&#39;:&#39;</code></td>
                            </tr>
                            <tr>
                              <td>errorHandler</td>
                              <td>错误处理函数</td>
                              <td>
                                <code
                                  >(error: Error) =&gt;
                                  void</code
                                >
                              </td>
                              <td><code>console.error</code></td>
                            </tr>
                          </tbody>
                        </table>
                        <h3
                          id="xreadablestream-接口"
                          tabindex="-1"
                        >
                          XReadableStream 接口
                          <a
                            class="header-anchor"
                            href="#xreadablestream-接口"
                            aria-label='Permalink to "XReadableStream 接口"'
                            >​</a
                          >
                        </h3>
                        <p>
                          扩展了标准
                          <code>ReadableStream</code
                          >，添加了以下功能：
                        </p>
                        <table tabindex="0">
                          <thead>
                            <tr>
                              <th>方法/属性</th>
                              <th>说明</th>
                              <th>类型</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>[Symbol.asyncIterator]</td>
                              <td>异步迭代器方法</td>
                              <td>
                                <code
                                  >() =&gt;
                                  AsyncGenerator&lt;T&gt;</code
                                >
                              </td>
                            </tr>
                            <tr>
                              <td>reader</td>
                              <td>流读取器引用</td>
                              <td>
                                <code
                                  >ReadableStreamDefaultReader&lt;T&gt;</code
                                >
                              </td>
                            </tr>
                            <tr>
                              <td>cancel</td>
                              <td>取消流处理</td>
                              <td>
                                <code
                                  >() =&gt;
                                  Promise&lt;void&gt;</code
                                >
                              </td>
                            </tr>
                          </tbody>
                        </table>
                        <h2 id="类型定义" tabindex="-1">
                          类型定义
                          <a
                            class="header-anchor"
                            href="#类型定义"
                            aria-label='Permalink to "类型定义"'
                            >​</a
                          >
                        </h2>
                        <div
                          class="language-typescript vp-adaptive-theme"
                        >
                          <button
                            title="Copy Code"
                            class="copy"
                          ></button
                          ><span class="lang">typescript</span>
                          <pre
                            class="shiki shiki-themes github-light github-dark vp-code"
                            tabindex="0"
                          ><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SSE字段类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SSEFields</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;data&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;event&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;id&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;retry&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SSE输出对象类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SSEOutput</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Partial</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Record</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SSEFields</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// XStream配置选项</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XStreamOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SSEOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  readableStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ReadableStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Uint8Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  transformStream</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> TransformStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Output</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  streamSeparator</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  partSeparator</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  kvSeparator</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  errorHandler</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">error</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 扩展的ReadableStream</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> XReadableStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SSEOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  extends</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ReadableStream</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  [Symbol.asyncIterator]()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AsyncGenerator</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  reader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ReadableStreamDefaultReader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre>
                        </div>
                        <h2 id="内部工作原理" tabindex="-1">
                          内部工作原理
                          <a
                            class="header-anchor"
                            href="#内部工作原理"
                            aria-label='Permalink to "内部工作原理"'
                            >​</a
                          >
                        </h2>
                        <p>
                          XStream
                          内部实现了一个完整的数据转换流水线：
                        </p>
                        <ol>
                          <li>
                            <strong>二进制流解码</strong>：使用
                            <code>TextDecoderStream</code> 将
                            <code>Uint8Array</code> 转换为文本
                          </li>
                          <li>
                            <strong>流分割</strong>：使用
                            <code>createSplitStream</code>
                            按指定分隔符将文本流分割成块
                          </li>
                          <li>
                            <strong>部分解析</strong>：使用
                            <code>createPartParser</code>
                            将文本块解析为结构化对象
                          </li>
                          <li>
                            <strong>异步迭代支持</strong>：扩展
                            <code>ReadableStream</code
                            >，添加异步迭代器和取消功能
                          </li>
                        </ol>
                        <p>
                          这一流水线设计使得 XStream
                          可以高效处理大量流式数据，同时保持内存使用效率。
                        </p>
                      </div>
                    </div>
                  </main>
                  <footer
                    class="VPDocFooter"
                    data-v-83890dd9
                    data-v-4f9813fa
                  >
                    <!--[--><!--]--><!---->
                    <nav
                      class="prev-next"
                      aria-labelledby="doc-footer-aria-label"
                      data-v-4f9813fa
                    >
                      <span
                        class="visually-hidden"
                        id="doc-footer-aria-label"
                        data-v-4f9813fa
                        >Pager</span
                      >
                      <div class="pager" data-v-4f9813fa>
                        <a
                          class="VPLink link pager-link prev"
                          href="/Aurora-X/components/Attachments/"
                          data-v-4f9813fa
                          ><!--[--><span
                            class="desc"
                            data-v-4f9813fa
                            >Previous page</span
                          ><span class="title" data-v-4f9813fa
                            >Attachments 附件</span
                          ><!--]--></a
                        >
                      </div>
                      <div class="pager" data-v-4f9813fa>
                        <!---->
                      </div>
                    </nav>
                  </footer>
                  <!--[--><!--]-->
                </div>
              </div>
            </div>
            <!--[--><!--]-->
          </div>
        </div>
        <!----><!--[--><!--]-->
      </div>
    </div>
    <script>
      window.__VP_HASH_MAP__ = JSON.parse(
        '{"changelog.md":"Dxkl6oXv","components_attachments_index.md":"2jT3hKal","components_bubble_index.md":"DEerl7SG","components_bubblelist_index.md":"DXBSlGuO","components_config_index.md":"DE8c2I46","components_typewriter_index.md":"DVqAuBil","components_xstream_index.md":"CxW8VXw7","guide_use.md":"Dz8TB19X","index.md":"C792QfOw"}'
      )
      window.__VP_SITE_DATA__ = JSON.parse(
        '{"lang":"en-US","dir":"ltr","title":"Aurora-X","description":"Aurora X 组件库文档","base":"/Aurora-X/","head":[],"router":{"prefetchLinks":true},"appearance":true,"themeConfig":{"nav":[{"text":"首页","link":"/"},{"text":"指南","link":"/guide/use/"},{"text":"组件","link":"/components/Bubble/"}],"sidebar":{"/guide/":[{"text":"入门","items":[{"text":"安装使用","link":"/guide/use/"}]}],"/components/":[{"text":"配置","items":[{"text":"Config 配置","link":"/components/Config/"}]},{"text":"输出","items":[{"text":"Bubble 气泡","link":"/components/Bubble/"},{"text":"BubbleList 气泡列表","link":"/components/BubbleList/"},{"text":"Typewriter 打字机","link":"/components/Typewriter/"}]},{"text":"输入","items":[{"text":"Attachments 附件","link":"/components/Attachments/"}]},{"text":"工具","items":[{"text":"XStream 流式数据处理","link":"/components/XStream/"}]}]},"socialLinks":[{"icon":"github","link":"https://github.com/cquptJerry0/Aurora-X"},{"icon":"npm","link":"https://www.npmjs.com/package/vue-aurora-x"}]},"locales":{},"scrollOffset":134,"cleanUrls":false}'
      )
    </script>
  </body>
</html>
